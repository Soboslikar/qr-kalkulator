<!DOCTYPE html>
<html lang="hr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>QR Kalkulator</title>
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
  <style>
    /* CSS - Tvoja verzija + izmjene stila za #delete-warning */
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 0.5em;
      background: #f4f4f4;
      overflow-x: hidden;
    }
    /* ... (ostali stilovi - header, scan-instruction, reader, total, invoice-count... ostaju isti) ... */
     #header {
      text-align: center;
      color: yellow;
      font-size: 1.2em;
      font-weight: bold;
      margin-bottom: 0.5em;
      position: absolute;
      width: 100%;
      left: 0;
      top: 0.5em;
      z-index: 3;
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
    }
    #scan-instruction {
      position: absolute;
      top: 2.8em;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      text-align: center;
      color: white;
      font-size: 1em;
      font-weight: bold;
      z-index: 2;
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.8);
      pointer-events: none;
      display: block;
    }
    #reader {
      width: 100%;
      max-width: 400px;
      margin: auto;
      height: 55vh;
      position: relative;
      border: 1px solid #ccc;
      background: #e0e0e0;
    }
    #total {
      display: block;
      font-size: 1.6em !important;
      font-weight: bold;
      color: yellow;
      background-color: rgba(0, 0, 0, 0.5);
      padding: 0.2em 0.5em;
      border-radius: 5px;
      position: fixed;
      top: 15em; /* Referentna točka */
      left: 50%;
      transform: translateX(-50%);
      z-index: 4;
      text-align: center;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
    }
    #invoice-count {
      font-size: 1.4em;
      color: black;
      padding: 0.1em 0.4em;
      position: fixed;
      bottom: 140px; /* Vaša vrijednost */
      right: 50px;   /* Vaša vrijednost */
      z-index: 2;
      text-align: right;
      font-weight: bold;
    }
    #amount-section {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1em;
      position: fixed;
      top: 28em; /* Pozicija */
      width: 100%;
      z-index: 4;
      min-height: 2.5em;
    }
    #amount-label {
      font-weight: bold;
      color: yellow;
      background-color: rgba(0, 0, 0, 0.5);
      padding: 0.2em 0.4em;
      border-radius: 3px;
      display: none;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
    }
    #current-amount {
      font-size: 1.5em;
      font-weight: bold;
       white;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      width: 130px;
      position: fixed;
      bottom: 10px;
      left: 10px;
      z-index: 1;
    }
    #history ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    #history li {
      padding: 0.5em 0;
      border-bottom: 1px solid #eee;
      white-space: pre;
      font-weight: bold;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: 1em;
    }
     #history li:last-child {
        border-bottom: none;
     }
     /* --- IZMJENA: Osnovni stil za #delete-warning --- */
    #delete-warning {
      /* Default stil (za "ZADNJE U LISTI...") */
      color: white; /* Bijela slova */
      background-color: rgba(0, 0, 0, 0.6); /* Prozračna tamna pozadina */
      text-shadow: 1px 1px 2px rgba(0,0,0,0.7); /* Sjena za čitljivost */
      box-shadow: none; /* Nema sjene okvira */

      /* Zajednički stilovi */
      font-weight: bold;
      display: none;
      text-align: center;
      position: fixed;
      top: 28em; /* Pozicija */
      left: 50%;
      transform: translateX(-50%);
      padding: 0.3em 0.6em;
      border-radius: 3px;
      z-index: 5;
      white-space: nowrap; /* Osigurava jedan red */
    }
    /* --- DODATAK: Stil za mod potvrde brisanja --- */
    #delete-warning.confirm-mode {
      color: red; /* Crvena slova */
      background-color: rgba(255, 255, 0, 0.8); /* Žuta pozadina */
      text-shadow: none; /* Makni sjenu teksta na žutoj pozadini */
      box-shadow: 0 1px 2px rgba(0,0,0,0.2); /* Vrati sjenu okvira */
    }
  </style>
</head>
<body>
  <!-- HTML (Tvoja originalna struktura) -->
  <div id="header">QR Kalkulator by Banović</div>
  <div id="scan-instruction">Pozicioniraj qr kod unutar kvadrata kamere</div>
  <div id="reader"></div>
  <div id="loaded-message">UČITANO</div>

  <div id="duplicate-warning">TAJ RAČUN JE URAČUNAT</div>

  <div id="total">UKUPNO: 0.00 €</div>
  <div id="invoice-count">0 RAČUNA</div>

  <div id="history">
    <ul id="historyList"></ul>
  </div>

  <div id="amount-section">
     <!-- Prazno -->
  </div>
  <!-- Poruka koja će se dinamički puniti -->
  <div id="delete-warning"></div>

  <button class="red-btn" id="clear-current-btn" onclick="clearCurrent()" style="display:none;">Obriši</button>
  <button class="red-btn" id="remove-from-list-btn" onclick="startRemoveFromList()" style="display:none;">Obriši iz liste</button>
  <button id="share-button" style="display: none;">PODIJELI NEKOME</button>


  <!-- Zvukovi -->
  <audio id="scan-sound"1em; border: none; border-radius: 5px; color: black; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
    button:active { box-shadow: inset 0 1px 2px rgba(0,0,0,0.3); }
    .red-btn { background: #ff0000; color: yellow; }
    .yellow-btn { background-color: yellow; color: black; }
    #remove-from-list-btn { position: fixed; bottom: 130px; right: 50px; z-index: 3; }
    #history-toggle-btn { position: fixed; bottom: 80px; right: 50px; z-index: 3; background-color: white; color: blue; font-weight: bold; }
    #share-button { position: fixed; bottom: 30px; right: 15px; z-index: 3; background-color: green; color: white; padding: 0.5em 1em; font-size: 1em; border: none; border-radius: 5px; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.2); font-weight: bold; animation: pulse-share 1.5s ease-in-out infinite; }
    #share-button:active { box-shadow: inset 0 1px 2px rgba(0,0,0,0.3); animation: none; }
    #history-page { display: none; }
    #history-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1em; border-bottom: 2px solid black; padding-bottom: 0.5em; }
    #history-header h1 { margin: 0; text-align: center; flex-grow: 1; font-size: 1.3em; }
    #back-to-scanner-btn { background-color: green; color: white; border: none; font-weight: bold; margin: 0; padding: 0.4em 0.8em; font-size: 0.9em; cursor: pointer; }
    #back-to-scanner-btn:active { background-color: darkgreen; }
    #history-content { flex-grow: 1; overflow-y: auto; padding-top: 0; position: relative; }
     #scan-group-list, #all-days-list-rendered, #search-results ul, #search-results-all-days ul { list-style: none; padding: 0; margin: 0; }
     #scan-group-list li, #all-days-list-rendered li, #search-results li, #search-results-all-days li { background-color: #f9f9f9; border: 1px solid #ddd; border-radius: 4px; padding: 10px 12px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; transition: background-color 0.2s ease; }
     #scan-group-list li:hover, #all-days-list-rendered li:hover, #search-results li:hover, #search-results-all-days li:hover { background-color: #efefef; }
     .scan-group-last-qr-time { font-size: 0.8em; color: #777; margin-left: 15px; flex-shrink: 0; }
     .session-name-history { font-size: 1em; color: #00008B; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-weight: bold; }
     .scan-time-history { font-size: 1em; color: #333; white-space: nowrap; margin-left: 5px; }
     #clear-history-btn.confirm-mode, #delete-session-btn.confirm-mode, #clear-day-btn.confirm-mode { background-color: yellow; color: black; }
     #detail-scan-list { list-style: none; padding: 0; margin: color: yellow;
      background-color: rgba(0, 0, 0, 0.5);
      padding: 0.2em 0.4em;
      border-radius: 3px;
      display: none;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
    }
    #duplicate-warning {
      font-weight: bold;
      color: red;
      background-color: rgba(255, 255, 255, 0.8);
      padding: 0.3em 0.8em;
      border-radius: 5px;
      border: 1px solid red;
      text-align: center;
      animation: pulse 0.5s ease-in-out 3 alternate;
      position: fixed;
      top: 12.8em;
      left: 50%;
      transform: translateX(-50%);
      z-index: 5;
      display: none;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    #loaded-message {
        font-weight: bold;
        color: green;
        display: none;
        text-align: center;
        font-size: 2em;
        position: fixed;
        top: 30%;
        left: 50%;
        transform: translate(-50%, -50%);
        animation: zoomFade 1s ease-out;
        z-index: 10;
        background-color: rgba(255, 255, 255, 0.85);
        padding: 0.8em 1.8em;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    @keyframes pulse {
      0% { transform: translateX(-50%) scale(1); }
      50% { transform: translateX(-50%) scale(1.1); }
      100% { transform: translateX(-50%) scale(1); }
    }
    @keyframes zoomFade {
      0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
      50% { transform: translate(-50%, -50%) scale(1.1); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
    }
    #clear-current-btn {
      position: fixed;
      bottom: 80px;
      right: 80px;
      z-index: 2;
    }
    #remove-from-list-btn {
      position: fixed;
      bottom: 100px;
      right: 50px;
      z-index: 3;
    }
    #share-button {
      position: fixed;
      bottom: 30px;
      right: 30px;
      z-index: 3;
      background-color: green;
      color: white;
      padding: 0.5em 1em;
      font-size: 1em;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      font-weight: bold;
    }
    #share-button:active {
        box-shadow: inset 0 1px 2px rgba(0,0,0,0.3);
    }
    button {
      padding: 0.5em 1em;
      font-size: 1em;
      border: none;
      border-radius: 5px;
      color: black;
      cursor: pointer;
       box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    button:active {
        box-shadow: inset 0 1px 2px rgba(0,0,0,0.3);
    }
    . src="https://actions.google.com/sounds/v1/cartoon/pop.ogg" preload="auto"></audio>
  <audio id="click-sound" src="https://cdn.jsdelivr.net/gh/himalayasingh/music-player-1@master/music/2.mp3" preload="auto"></audio>
  <audio id="remove-sound" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg" preload="auto"></audio>

  <!-- JavaScript (Tvoja verzija + minimalna izmjena handleAmountLabelVisibility) -->
  <script>
    // === POČETAK TVOJE ORIGINALNE SKRIPTE ===
    let ukupno = 0;
    let povijest = [];
    let removeConfirm = false;

    const totalDiv = document.getElementById('total');
    const invoiceCountDiv = document.getElementById('invoice-count');
    const amountLabel = document.getElementById('amount-label');
    const historyList = document.getElementById('historyList');
    const removeButton = document.getElementById('remove-from-list-btn');
    const duplicateWarning = document.getElementById('duplicate-warning');
    const loadedMsg = document.getElementById('loaded-message');
    const instructionDiv = document.getElementById('scan-instruction');
    const removeBtnInitialText = 'Obriši iz liste';
    const deleteWarningDiv = document.getElementById('delete-warning');

    // Tvoja originalna updateDisplay funkcija
    function updateDisplay() {
      totalDiv.innerText = `UKUPNO: ${ukupno.toFixed(2)} €`;
      const count = povijest.length;
      invoiceCountDiv.innerText = `${count} ${count === 1 ? 'RAČUN' : 'RAČUNA'}`;
      if (count === 0) invoiceCountDiv.innerText = '0 RAČUNA';

      document.getElementById('current-amount').style.display = 'none';
      if (!amountLabel.classList.contains('delete-mode')) {
         amountLabel.style.display = 'none';
      }
      //0; }
     #detail-scan-list li {display: flex; justify-content: space-between; align-items: center; padding: 0.6em 0.2em; border-bottom: 1px solid #eee; font-size: 1.05em;}
     #detail-scan-list li:last-child { border-bottom: none; }
     #all-days-search-container { position: sticky; top: 0; background-color: white; padding: 0.5em 0.2em; border-bottom: 1px solid #eee; z-index: 10; margin-bottom: 0.2em; }
     #all-days-search-container input { flex-grow: 1; padding: 0.5em; min-width: 50px; }
     #all-days-search-container button { padding: 0.5em 0.6em; font-size: 0.9em; flex-shrink: 0; }
     #all-days-list-rendered li { background-color: #f0f0f0; border: 1px solid #ccc; padding: 12px 15px; margin-bottom: 8px; }
     #all-days-list-rendered li:hover { background-color: #e0e0e0; }
    @keyframes pulse-share { 0% { transform: scale(1); } 50% { transform: scale(1.08); } 100% { transform: scale(1); } }
  </style>
</head>
<body class="scanner-view">

  <!-- Scanner View elementi -->
  <div id="header">QR SKENER-KALKULATOR</div>
  <div id="scan-instruction">Pozicioniraj qr kod unutar kvadrata kamere</div>
  <div id="reader"></div>
  <div id="loaded-message" style="display: none;">UČITANO</div>
  <div id="duplicate-warning" style="display: none;">TAJ RAČUN JE URAČUNAT</div>
  <div id="total-container">
      <div id="total">UKUPNO: 0.00 €</div>
      <button id="ocisti-button" onclick="startOcistiConfirm()" style="display: none;">SPREMI<br>I OČISTI</button>
  </div>
  <div id="session-red-btn {
      background: #ff0000;
      color: yellow;
    }
    .yellow-btn {
        background-color: yellow;
        color: black;
    }
    #history {
      max-height: 200px;
      overflow-y: auto;
      margin: 0;
      padding: 1em;
      background: white;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      width: 130px;
      position: fixed;
      bottom: 10px;
      left: 10px;
      z-index: 1;
    }
    #history ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    #history li {
      padding: 0.5em 0;
      border-bottom: 1px solid #eee;
      white-space: pre;
      font-weight: bold;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: 1em;
    }
     #history li:last-child {
        border-bottom: none;
     }
     /* --- IZMJENA: Osnovni stil za #delete-warning (info mod) --- */
    #delete-warning {
      /* Default stil (za "ZADNJE U LISTI...") */
      color: white; /* Bijela slova */
      background-color: transparent; /* Bez pozadine */
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8); /* Sjena za čitljivost */

      /* Zajednički stilovi */
      font-weight: bold;
      display: none;
      text-align: center;
      position: fixed;
      top: 28em;
      left: 50%;
      transform: translateX(-50%);
      padding: 0.3em 0.6em; /* Malo paddinga ipak treba */
      border-radius: 3px;
      z-index: 5;
      white-space: nowrap; /* Osigurava jedan red */
      box-shadow: none; /* Nema sjene okvira po defaultu */
    }
    /* --- DODATAK: Stil za mod potvrde brisanja --- */
    #delete-warning.confirm-delete-style {
 duplicateWarning se kontrolira u handleScan
      document.getElementById('clear-current-btn').style.display = 'none';

      updateHistory();
      checkRemoveButtonVisibility();
      handleAmountLabelVisibility(); // Ovaj poziv ostaje
    }

    // Tvoja originalna updateHistory funkcija
    function updateHistory() {
      historyList.innerHTML = '';
      povijest.forEach((item, index) => {
        const listItem = document.createElement('li');
        listItem.innerText = `${index + 1}. ${item.time} - ${item.amount.toFixed(2)} €`;
        historyList.appendChild(listItem);
      });
      const historyDiv = document.getElementById('history');
      historyDiv.scrollTop = historyDiv.scrollHeight;
    }

    // Tvoja originalna checkRemoveButtonVisibility funkcija
     function checkRemoveButtonVisibility() {
        removeButton.style.display = povijest.length > 0 ? 'block' : 'none';
        if (name-container">
      <button id="add-name-btn" onclick="startAddName()">DODAJ NAZIV</button>
      <input type="text" id="session-name-input" placeholder="Unesi naziv sesije..." maxlength="30">
      <span id="session-name-display">
          <span id="session-name-text"></span>
          <span class="edit-icon" onclick="startAddName()">Uredi</span>
      </span>
  </div>
  <div id="invoice-count">0 RAČUNA</div>
  <div id="history" style="display: none;"> <ul id="historyList"></ul> </div>
  <button class="red-btn" id="remove-from-list-btn" onclick="startRemoveFromList()" style="display:none;">Obriši iz liste</button>
  <button id="history-toggle-btn">POVIJEST</button>
  <button id="share-button" style="display: none;">DIJELI KALKULATOR</button>
  <div id="delete-warning" style="display: none;"></div> <!-- Ovaj div sada prikazuje obje poruke -->
  <!-- Kraj Scanner View elemenata -->

  <!-- History View elementi -->
  <div id="history-page">
      <div id="history-header">
          <button id="back-to-scanner-btn">< NA SKENER</button>
          <h1>POVIJEST</h1>
      </div>
      <div id="search-container" style="display: none      color: red; /* Crvena slova */
      background-color: rgba(255, 255, 0, 0.8); /* Žuta pozadina */
      text-shadow: none; /* Makni sjenu teksta na žutoj pozadini */
      box-shadow: 0 1px 2px rgba(0,0,0,0.2); /* Dodaj sjenu okvira */
    }
  </style>
</head>
<body>
  <!-- HTML (Tvoja originalna struktura) -->
  <div id="header">QR Kalkulator by Banović</div>
  <div id="scan-instruction">Pozicioniraj qr kod unutar kvadrata kamere</div>
  <div id="reader"></div>
  <div id="loaded-message">UČITANO</div>

  <div id="duplicate-warning">TAJ RAČUN JE URAČUNAT</div>

  <div id="total">UKUPNO: 0.00 €</div>
  <div id="invoice-count">0 RAČUNA</div>

  <div id="history">
    <ul id="historyList"></ul>
  </div>

  <div id="amount-section">
     <!-- Prazno -->
  </div>
  <!-- Poruka koja će se dinamički puniti -->
  <div id="delete-warning"></div>

  <button class="red-btn" id="clear-current-btn" onclick="clearCurrent()" style="display:none;">Obriši</button>
  <button class="red-btn" id="remove-from-list-btn" onclick="startRemoveFromList()" style="display:none;">Obpovijest.length === 0 && removeConfirm) {
            removeButton.innerText = removeBtnInitialText;
            removeButton.classList.remove('yellow-btn');
            removeButton.classList.add('red-btn');
            removeConfirm = false;
            handleAmountLabelVisibility(); // Ovaj poziv ostaje
        }
    }

    // === IZMJENA FUNKCIJE handleAmountLabelVisibility ===
    function handleAmountLabelVisibility() {
        // Uvijek sakrij stari amount-label ako postoji
        const amountLabel = document.getElementById('amount-label');
        if(amountLabel) {
             amountLabel.style.display = 'none';
             amountLabel.classList.remove('delete-mode'); // Za svaki slučaj
        }

        if (removeConfirm && povijest.length > 0) {
            // Prikaz potvrde brisanja u #delete-warning
            const lastItem = povijest[povijest.length - 1];
            // IZMJENA TEKSTA ZA POTVRDU
            deleteWarningDiv.innerText = `OBRIŠI IZ LISTE: ${lastItem.time} - ${lastItem.amount.toFixed(2)} €?`;
            deleteWarningDiv.classList.add('confirm-mode'); // Dodaj klasu za žutu pozadinu/crvena slova
            deleteWarningDiv.style.display = 'block';
        } else if (!removeConfirm && povijest.; padding: 1em 0; border-bottom: 1px solid #eee; margin-bottom: 1em;">
          <div style="display: flex; gap: 10px; margin-bottom: 0.8em;">
              <input type="text" id="search-input" placeholder="Traži datum, dan, naziv..." style="flex-grow: 1; padding: 0.5em;">
              <button id="execute-search-btn" style="padding: 0.5em 1em;">Traži</button>
              <button id="close-search-btn" style="padding: 0.5em 1em; background-color: #ccc;">Zatvori</button>
          </div>
          <div id="search-summary-info-day" style="display: none; justify-content: space-between; align-items: center; padding: 0.6em 0.2em; font-size: 1.1em; margin-top: 0.8em; border-top: 1px solid #eee;"></div>
          <div id="search-results"></div>
      </div>
      <div idriši iz liste</button>
  <button id="share-button" style="display: none;">PODIJELI NEKOME</button>


  <!-- Zvukovi -->
  <audio id="scan-sound" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg" preload="auto"></audio>
  <audio id="click-sound" src="https://cdn.jsdelivr.net/gh/himalayasingh/music-player-1@master/music/2.mp3" preload="auto"></audio>
  <audio id="remove-sound" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flickslength > 0) {
            // Prikaz informacije o zadnjem računu u #delete-warning
            const lastItem = povijest[povijest.length - 1];
            deleteWarningDiv.innerText = `ZADNJE U LISTI: ${lastItem.time} - ${lastItem.amount.toFixed(2)} €`;
            deleteWarningDiv.classList.remove('confirm-mode'); // Ukloni klasu (za bijela slova/prozračnu pozadinu)
            deleteWarningDiv.style.display = 'block';
        } else {
            // Sak="history-content">
          <!-- Sadržaj generira JS -->
      </div>
  </div>
  <!-- Kraj History View elemenata -->

  <!-- Zvukovi -->
  <audio id="scan-sound" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg" preload="auto"></audio>
  <audio id="click.ogg" preload="auto"></audio>

  <!-- JavaScript (Tvoja verzija + izmjena handleAmountLabelVisibility) -->
  <script>
    // === POČETAK TVOJE ORIGINALNE SKRIPTE (do modifikacije funkcije) ===
    let ukupno = 0;
    let povijest = [];
    let removeConfirm = false;

    const totalDiv = document.getElementById('total');
    const invoiceCountDiv = document.getElementById('invoice-count');
    // const amountLabel = document.getElementById('amount-label'); // Ne treba
    const historyList = document.getElementById('historyList');
    const removeButton = document.getElementByIdrij #delete-warning ako je lista prazna
            deleteWarningDiv.style.display = 'none';
            deleteWarningDiv.classList.remove('confirm-mode'); // Ukloni klasu za svaki slučaj
        }
    }
    // === KRAJ IZMJENE FUNKCIJE handleAmountLabelVisibility ===

    // Tvoja originalna playSound funkcija
     function playSound(id) {
      const sound = document.getElementById(id);
      if (sound) {
        sound.pause();
        sound.currentTime = 0;
        const playPromise = sound-sound" src="https://cdn.jsdelivr.net/gh/himalayasingh/music-player-1@master/music/2.mp3" preload="auto"></audio>
  <audio id="remove-sound" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg" preload="auto"></audio>

  <script>
    // *** GLOBALNE VARIJ('remove-from-list-btn');
    const duplicateWarning = document.getElementById('duplicate-warning'); // Gornje
    const loadedMsg = document.getElementById('loaded-message');
    const instructionDiv = document.getElementById('scan-instruction');
    const removeBtnInitialText = 'Obriši.play();
        if (playPromise !== undefined) {
          playPromise.then(_ => {}).catch(error => {
            if (ABLE I KONSTANTE ***
    const MAX_HISTORY_ITEMS = 500; const HISTORY_STORAGE_KEY = 'qrCalculatorHistory';
    let ukupno = 0; let povijest = []; let removeConfirm = false; iz liste';
    const deleteWarningDiv = document.getElementById('delete-warning'); // Donje

    function updateDisplay() {
      totalDiverror.name !== 'NotAllowedError') {
                console.warn(`Zvuk "${id}" nije mogao biti reproduciran:`, error);
            }
          });
        }
      } else {
          console.warn(`Audio element s ID-jem "${id}" nije pronađen.`);
      }
 let ocistiConfirm = false;
    const removeBtnInitialText = 'Obriši iz liste'; const ocistiBtnInitialText = 'SPREMI<br>I OČISTI'; const ocistiConfirmText = 'Potvrdi<br>SPREMANJE?';
    let html5QrCodeInstance = null; let isScannerActive = false; let currentCameraId = null;.innerText = `UKUPNO: ${ukupno.toFixed(2)} €`;
      const count = povijest.length;
      invoiceCountDiv.innerText = `${count} ${count === 1 ? 'RAČUN' : 'RAČUNA'}`;
      if (count ===    }

    // Tvoja originalna clearCurrent funkcija
    function clearCurrent() {
      console.log("clearCurrent pozvan, ali let visibilityListenerAttached = false;
    let currentSessionName = null; let removeNameConfirm = false;
    let currentlyViewedDate = new Date(); currentlyViewedDate 0) invoiceCountDiv.innerText = '0 RAČUNA';

      // Sakrij neiskorištene elemente
      document.getElementById('current nema efekta.");
    }

    // Tvoja originalna startRemoveFromList funkcija (poziva modificiranu handleAmountLabelVisibility)
.setHours(0, 0, 0, 0);
    let previousHistoryViewState = 'day-view'; let lastSearchTerm = '';-amount').style.display = 'none';
      const amountLabel = document.getElementById('amount-label');
      if (amountLabel) amount    function startRemoveFromList() {
      if (!removeConfirm) {
        removeButton.innerText = 'Potvrdi';
        removeButton.classList.remove('red-btn');
        removeButton.classList.
    let totalDiv, totalContainer, ocistiButton, invoiceCountDiv, historyList, removeButton, duplicateWarning, loadedMsg, instructionDiv, deleteWarningLabel.style.display = 'none';
      document.getElementById('clear-current-btn').style.display = 'none';

      updateHistoryadd('yellow-btn');
        removeConfirm = true;
        playSoundDiv, shareButton, readerDiv, historyToggleButton, historyDiv, historyPageDiv, backToScannerButton, historyContentDiv, sessionNameContainer, addNameBtn, sessionNameInput, sessionNameDisplay, sessionNameText;

    // *** POMOĆNE();
      checkRemoveButtonVisibility();
      handleAmountLabelVisibility(); // Pozovi funkciju za ažuriranje donje poruke
    }

    function update('click-sound');
        handleAmountLabelVisibility();
      } else FUNKCIJE ***
    const parseTime = (timeStr) =>History() {
      historyList.innerHTML = '';
      povijest {
        if (povijest.length > 0) {
          const removed = povijest.pop();
          ukupno -= removed { if (!timeStr || typeof timeStr !== 'string' || timeStr === '??:??' || timeStr.length !== 5 || time.forEach((item, index) => {
        const listItem = document.createElement('li');
        listItem.innerText = `${index + 1}..amount;
          playSound('remove-sound');
        }
        removeButton.innerText = removeBtnInitialText;
        removeButton.classList.remove('yellow-btn');
        removeButton.classList.add('Str[2] !== ':') return -1; const parts = timeStr.split(':'); const hours = parseInt(parts[0], 10 ${item.time} - ${item.amount.toFixed(2)} €`;
        historyList.appendChild(listItem);
      });
      constred-btn');
        removeConfirm = false;
        updateDisplay();
      }
    }

    // Tvoj originalni event listener (); const minutes = parseInt(parts[1], 10); if (isNaN(hours) || isNaN(minutes) || hours < 0 || historyDiv = document.getElementById('history');
      historyDiv.scrollTop =poziva modificiranu handleAmountLabelVisibility)
    document.body.addEventListener('click', (event) => {
        if (removeConfirm && !removeButton.contains(event.target) && !deleteWarningDiv.contains(event hours > 23 || minutes < 0 || minutes > 59 historyDiv.scrollHeight;
    }

     function checkRemoveButtonVisibility() {
        removeButton.style.display = povijest.length > 0.target)) {
            removeButton.innerText = removeBtnInitialText;) return -1; return hours * 60 + minutes; };
    function playSound(id) { const sound = document.getElementById(id); if ? 'block' : 'none';
        if (povijest.length === 0 && removeConfirm) {
            removeButton.innerText =
            removeButton.classList.remove('yellow-btn');
            removeButton.classList.add('red-btn');
            removeConfirm = false (sound) { sound.pause(); sound.currentTime = 0; sound.play().catch(error => { if (error.name !== 'Not removeBtnInitialText;
            removeButton.classList.remove('yellow-btn');
            removeButton.classList.add('red-btn');
            removeConfirm = false;
            handleAmountLabelVisibility(); // Až;
            handleAmountLabelVisibility();
        }
    }, true);


    // Tvoja originalna handleScan funkcija (poziva modificiranu handleAmountLabelVisibility)
    function handleScan(decodedText) {AllowedError' && error.name !== 'AbortError') console.warn(`Zvuk "${id}" greška:`, error); }); } else console.warn(`uriraj donju poruku
        }
    }

    // === IZMJENA FUNKCIJE handleAmountLabelVisibility ===
    function handleAmountLabelVisibility() {
        // const amountLabel = document.getElementById('amount
       if (removeConfirm) {
           removeButton.innerText = removeBtnInitialText;
           removeButton.classList.remove('yellow-btnAudio element "${id}" nije pronađen.`); }
    function getISODateString(date) { if (!(date instanceof Date) || isNaN(date)) { console.error("getISODateString primio neispravan datum:", date); return null-label'); // Ne treba
        // if (amountLabel) amountLabel.style.display = 'none'; // Osiguraj da je stari label skriven

        if (removeConfirm && povijest.length > 0');
           removeButton.classList.add('red-btn');
           ; } const year = date.getFullYear(); const month = String(date.getMonth() + 1).padStart(2, '0'); const day = String(date) {
            // Prikaz potvrde brisanja u #delete-warningremoveConfirm = false;
           handleAmountLabelVisibility();
       }

.getDate()).padStart(2, '0'); return `${year}-${month}-${day}`; }

    // *** FUNKCIJE ZA LOKALNU
            const lastItem = povijest[povijest.length - 1];
            // Novi tekst za potvrdu
            deleteWarningDiv.innerText =       try {
           const qrParts = decodedText.split('?');
           if (qrParts.length < 2) {
               console POHRANU ***
    function saveFullHistoryToLocalStorage(fullHistory) { try { localStorage.setItem(HISTORY_STORAGE_KEY, JSON.stringify `OBRIŠI IZ LISTE: ${lastItem.time} -.warn("QR kod nema očekivani format (nedostaje '?'):", decoded(fullHistory)); console.log("Puna povijest spremljena."); ${lastItem.amount.toFixed(2)} €?`;
            deleteWarningDiv.classList.add('confirm-delete-style'); // DodajText);
               return;
           }
           const params = new URL } catch (error) { console.error("Greška spremanja:", klasu za žuto/crveno
            deleteWarningDiv.style.display = 'block';
        } else if (!removeConfirm && povijSearchParams(qrParts[1]);
           const iznosCentStr = params.get('izn');
           const datv = params.get('est.length > 0) {
            // Prikaz informacije o zadnjemdatv');

           if (iznosCentStr && !isNaN(parseFloat računu u #delete-warning
            const lastItem = povijest[ error); alert("Greška: Nije moguće spremiti povijest."); } }
    function loadFullHistoryFromLocalStorage() { try { const historyJson = localStorage.getItem(HISTORY_STORAGE_KEY); if (historyJson) { const loadedHistory = JSON.parse(historyJson); return loadedHistory.map((iznosCentStr))) {
               const iznosCenti = parseFloatpovijest.length - 1];
            deleteWarningDiv.innerText = `ZADNJE U LISTI: ${lastItem.time} - ${lastItemgroup => ({ timestamp: group.timestamp || Date.now(), lastQrTime: group.lastQrTime || '??:??', name: group.name ||(iznosCentStr);
               const iznosEura = iznos.amount.toFixed(2)} €`;
            deleteWarningDiv.classList null, racuni: Array.isArray(group.racuni) ? groupCenti / 100;
               let time = '??:.remove('confirm-delete-style'); // Ukloni klasu (.racuni.map(item => ({ ...item, scanTimestamp: item.scanTimestamp || 0 })) : [] })); } return []; } catch (??';
               if (datv && datv.length >= 1za bijelo/transparentno)
            deleteWarningDiv.style.display = 'block';
        } else {
            // Sakrij #delete-warning akoerror) { console.error("Greška učitavanja:", error); return3) {
                   const hour = datv.substring(9, 11);
                   const minute = datv.substring(11, 13);
                   if (!isNaN(parseInt(hour)) && ! je lista prazna
            deleteWarningDiv.style.display = 'none []; } }

    // *** FUNKCIJE ZA AŽURIRANJE PRIKAZA ***
    function checkOcistiButtonVisibility()isNaN(parseInt(minute))) {
                       time = `${hour}:${minute}`;';
            deleteWarningDiv.classList.remove('confirm-delete-style'); // Ukloni klasu za svaki slučaj
        }
    }
     { if (!ocistiButton) return; ocistiButton.style.display
                   }
               }

               const existingItem = povijest.// === KRAJ IZMJENE FUNKCIJE handleAmountLabelVisibility === = (povijest.length > 0 || currentSessionName) ?find(item => item.qrCode === decodedText);

               loadedMsg.style.display = 'none';
               duplicateWarning.style.display = 'none


     function playSound(id) {
      const sound = document.getElementById( 'block' : 'none'; if (povijest.length === 0 &&';

               if (existingItem) {
                   duplicateWarning.style.id);
      if (sound) {
        sound.pause();
 !currentSessionName && ocistiConfirm) { resetOcistiMode(); } } // Ažurirano: provjerava i naziv
    function updatedisplay = 'block';
                   duplicateWarning.style.animation = 'none        sound.currentTime = 0;
        const playPromise = sound.Display() { if (totalDiv) totalDiv.innerText = `UKUPNO:';
                   duplicateWarning.offsetHeight;
                   duplicateWarning.style.animationplay();
        if (playPromise !== undefined) {
          playPromise.then(_ => {}).catch(error => {
            if (error ${ukupno.toFixed(2)} €`; const count = povijest.length; = 'pulse 0.5s ease-in-out 3 alternate';
                   setTimeout(() => {
                       if (duplicateWarning.style..name !== 'NotAllowedError') {
                console.warn(`Zvuk "${id}" nije mogao biti reproduciran:`, error);
            } if (invoiceCountDiv) invoiceCountDiv.innerText = `${count} ${count === display === 'block') {
                           duplicateWarning.style.display = '
          });
        }
      } else {
          console.warn(`Audio element s ID-jem "${id}" nije pronađen.`);
      1 ? 'RAČUN' : 'RAČUNA'}`; if (document.body.classList.contains('scanner-view')) { updateSmallHistoryList(); checknone';
                       }
                   }, 1500);

               }
    }

    function clearCurrent() {
      console.log("clearCurrent pozvan, ali nema efekta.");
    }

    // startRemoveRemoveButtonVisibility(); handleAmountLabelVisibility(); checkOcistiButtonVisibility(); updateNameDisplay(); } } // Promjena: poziva handleAmountLabelVisibility
    function updateSmallHistoryList} else {
                   if (instructionDiv.style.display !== 'none') {
                       instructionDiv.style.display = 'none';
                   FromList OSTAJE KAO U TVOM KODU
    function startRemoveFromList() {
      if (!removeConfirm) {
        () { if (!historyList || !historyDiv) return; if (povijest.length > 0) { historyDiv.style.display = 'block}

                   povijest.push({
                       amount: iznosEremoveButton.innerText = 'Potvrdi';
        removeButton.classList.remove('red-btn');
        removeButton.classList.add('yellow-btn');
        removeConfirm = true;
        playSound('click-sound');
        handleAmountLabelVisibility(); // Pozovi modificiranu'; historyList.innerHTML = ''; const recentHistory = povijest.slice(-10); recentHistory.forEach((item, index) => { constura,
                       qrCode: decodedText,
                       time: time
                   });
                   ukupno += iznosEura;
                   updateDisplay funkciju
      } else {
        if (povijest.length > 0) {
          const removed = povijest.pop(); globalIndex = povijest.length - recentHistory.length + index; const listItem = document.createElement('li'); listItem.innerText = `${globalIndex + 1}. ${item.time} - ${item.amount.toFixed((); // Ovaj poziv će ažurirati i donju poruku
                   playSound('scan-sound');

                   loadedMsg.style.display = 'block';

          ukupno -= removed.amount;
          playSound('remove-sound');
        }
        removeButton.innerText = removeBtnInitialText;
        removeButton.classList.remove('yellow-btn');
        removeButton2)} €`; historyList.appendChild(listItem); }); historyDiv.scrollTop                   loadedMsg.style.animation = 'none';
                   loadedMsg.offsetHeight;
                   loadedMsg.style.animation = 'zoomFade 1.classList.add('red-btn');
        removeConfirm = false; = historyDiv.scrollHeight; } else { historyDiv.style.display =s ease-out';
                   setTimeout(() => {
                        if (loaded
        updateDisplay(); // Pozovi updateDisplay koji će pozvati handleAmountLabelVisibility
 'none'; } }
    function checkRemoveButtonVisibility() { if (!removeButton) return; removeButton.style.display = (povijestMsg.style.display === 'block') {
                           loadedMsg.style.display = 'none';
                        }
                   }, 1000);
               }
           } else {
              console.warn("      }
    }

    // Listener OSTAJE KAO U TVOM KODU
    document.body.addEventListener('click', (event.length > 0 || currentSessionName) ? 'block' : 'none'; if (povijest.length === 0 && !currentSessionQR kod ne sadrži validan 'izn' parametar ili 'iz) => {
        if (removeConfirm && !removeButton.contains(event.target) && !deleteWarningDiv.contains(event.target))Name && (removeConfirm || removeNameConfirm)) resetRemoveMode(); }

    // === IZMJENA FUNKCIJE handleAmountLabelVisibility ===
    function handlen' nije broj:", decodedText);
           }
       } catch (error) {
           if (error instanceof TypeError && error.message.includes {
            removeButton.innerText = removeBtnInitialText;
            removeButton.classList.remove('yellow-btn');
            removeButton.classListAmountLabelVisibility() {
        // Sakrij stari label ako postoji (uvijek)
        const amountLabel = document.getElementById('amount-label');
        if (amountLabel) {
            amountLabel.style.display = '("URLSearchParams")) {
               console.warn("Skenirani tekst nije validan URL ili query string:", decodedText);
           } else {
               console.error("Neočekivana greška pri obradi QR k.add('red-btn');
            removeConfirm = false;
            handleAmountLabelVisibility(); // Pozovi modificiranu funkciju
        }
    }, true);


    // handleScan OSTAJE KAO U TVOM KODU
    function handleScan(decodedText) {
       if (none';
            amountLabel.classList.remove('delete-mode'); // Osiguraj da nema ovu klasu
        }

        if (removeConfirm &&oda:", error, decodedText);
           }
           loadedMsg.styleremoveConfirm) {
           removeButton.innerText = removeBtnInitialText;
           removeButton.classList.remove('yellow-btn');
           remove povijest.length > 0) {
            // Stanje .display = 'none';
           duplicateWarning.style.display = 'Button.classList.add('red-btn');
           removeConfirm = false1: Potvrda brisanja računa
            const lastItem = povijestnone';
           // Sakrij i donju poruku u slučaju greške
;
           handleAmountLabelVisibility(); // Pozovi modificiranu funkciju
       }

       try {
           const qrParts = decodedText.[povijest.length - 1];
            // IZMJENA: Koristi tvoj originalni tekst za potvrdu brisanja
            deleteWarningDiv.innerText =           if (deleteWarningDiv) deleteWarningDiv.style.display = 'none';
       }
    }

    // Tvoja originalna inicijalizacija skenera
    const html5QrCode = new Html5Qrcode("split('?');
           if (qrParts.length < 2) {
               console.warn("QR kod nema očekivani format (ned `OBRIŠI ${lastItem.time} = ${lastItem.amount.toFixed(2)} €?`;
            deleteWarningDiv.classList.addreader");
    const qrConfig = { fps: 5, qrbox: { width: 250, height: 250 }ostaje '?'):", decodedText);
               return;
           }
           const params = new URLSearchParams(qrParts[1]);
           const iznosCentStr = params.get('izn');
           const dat('confirm-mode'); // Dodaj klasu za žuto/crveno };

    Html5Qrcode.getCameras().then(devices => {
      if (devices && devices.length) {
        html5Qrv = params.get('datv');

           if (iznosCentStr && !isNaN(parseFloat(iznosCentStr))) {
               const
            deleteWarningDiv.style.display = 'block';
        } else if (removeNameConfirm && currentSessionName) {
             // StanCode.start(
          { facingMode: "environment" },
          qrConfig,
          handleScan,
          (errorMessage) => { /* Ignoriraj greške detekcije */ }
        ).then(() => iznosCenti = parseFloat(iznosCentStr);
               const iznosEura = iznosCenti / 100;
               je 2: Potvrda brisanja naziva
            deleteWarningDiv.innerText = `OBRIŠI NAZIV "${currentSessionName}"?`;
            deleteWarningDiv.classList.add('confirm-mode'); // Dodaj klasu {
            console.log("QR skener pokrenut.");
            updateDisplay(); // Inicijalni prikaz
        }).catch(err =>let time = '??:??';
               if (datv && datv.length >= 13) {
                   const hour = datv.substring(9, 11);
                   const minute = datv.substring(11, 13);
                   if (!isNaN( za žuto/crveno
            deleteWarningDiv.style.display = 'block';
        } else if (!removeConfirm && !removeNameConfirm {
            console.error("Greška kod startanja QR skenera:", err);
            const readerDiv = document.getElementById('reader');
parseInt(hour)) && !isNaN(parseInt(minute))) {
                       time = `${hour}:${minute}`;
                   }
               }

               const existing && povijest.length > 0) {
            // Stanje 3: Prikaz zadnjeg računa (default)
            const lastItem = povijest[povijest.length - 1];
            readerDiv.innerHTML = `<div style="padding: 20px; text-align: center; color: red; font-weight: boldItem = povijest.find(item => item.qrCode === decodedText);

               loadedMsg.style.display = 'none';
                           deleteWarningDiv.innerText = `ZADNJE U LISTI: ${lastItem.time} - ${lastItem.amount.toFixed(2)};">Greška pri pokretanju kamere. Provjerite dozvole iduplicateWarning.style.display = 'none'; // Gornje upozorenje

               if (existingItem) {
                   duplicateWarning.style.display = 'block';
                   duplicateWarning.style.animation = 'none €`;
            deleteWarningDiv.classList.remove('confirm-mode'); // Ukloni klasu (za bijelo/tamno)
             osvježite stranicu.</div>`;
            instructionDiv.style.display = 'none';
        });
      } else {
          console.';
                   duplicateWarning.offsetHeight;
                   duplicateWarning.style.animationdeleteWarningDiv.style.display = 'block';
        } else {
            // Stanje 4: Lista prazna i nije u modu potvrerror("Nema dostupnih kamera.");
          const readerDiv = document.getElementById('reader');
          readerDiv.innerHTML = `<div style="padding = 'pulse 0.5s ease-in-out 3 alternate';
                   setTimeout(() => {
                       if (duplicateWarning.style.display === 'block') {
                           duplicateWarning.style.display = 'de -> Sakrij
            deleteWarningDiv.style.display = 'none';
            deleteWarningDiv.classList.remove('confirm-mode'); // Ukloni klas: 20px; text-align: center; color: red; font-weight: bold;">Nema dostupnih kamera.</div>`;
          none';
                       }
                   }, 1500);

               } else {
                   // Novi račun
                   if (instructionDiv.styleu za svaki slučaj
        }
    }
    // === KRAJinstructionDiv.style.display = 'none';
      }
    })..display !== 'none') {
                       instructionDiv.style.display = 'none';
                   }

                   povijest.push({
                        IZMJENE FUNKCIJE handleAmountLabelVisibility ===

    // ***catch(err => {
      console.error("Greška kod dohvaamount: iznosEura,
                       qrCode: decodedText,
                       time: time
                   });
                   ukupno += iznosEura FUNKCIJE ZA RESETIRANJE STANJA GUMBA ***
    function resetRemoveMode() { if (!removeButton) return; removeButton.innerText = removeBtnInitialText; removeButton.classList.remove('yellow-btnćanja kamera:", err);
      const readerDiv = document.getElementById('reader');
      readerDiv.innerHTML = `<div style="padding: 20px; text-align: center; color: red; font-;
                   updateDisplay(); // Zove updateDisplay koji će pozvati handle'); removeButton.classList.add('red-btn'); removeConfirm = false; removeNameConfirm = false; handleAmountLabelVisibility(); checkRemoveButtonVisibility();weight: bold;">Greška pri pristupu kamerama. Provjerite dozvole preglednika.</div>`;
      instructionDiv.style.display =AmountLabelVisibility
                   playSound('scan-sound');

                   loadedMsg.style.display = 'block';
                   loadedMsg.style.animation = 'none';
                   loadedMsg.offsetHeight;
                   loadedMsg.style.animation }
    function resetOcistiMode() { if (!ocistiButton) 'none';
    });

    // Tvoj originalni dodatak za Web Share API
    const shareButton = document.getElementById('share-button = 'zoomFade 1s ease-out';
                   setTimeout(() => {
                        if (loadedMsg.style.display === 'block') { return; ocistiButton.innerHTML = ocistiBtnInitialText; ocistiButton.classList.remove('confirm-mode'); ocistiConfirm = false; check');

    if (navigator.share) {
      shareButton.style.display = 'block';

      shareButton.addEventListener('click', async () =>
                           loadedMsg.style.display = 'none';
                        }
OcistiButtonVisibility(); }

    // *** FUNKCIJE ZA NAZIV SESIJE ***
    function startAddName() { if (! {
        try {
          const shareData = {
            title: 'QR Kalkulator',
            text: 'Isprobaj praktič                   }, 1000);
               }
           } else {addNameBtn || !sessionNameInput || !sessionNameDisplay) return; playSound('click-sound'); addNameBtn.style.display = 'none'; sessionNamean skener-kalkulator za goste ili konobare',
            url: 'https://soboslikar.github.io/qr
              console.warn("QR kod ne sadrži validan 'izn' parametar ili 'izn' nije broj:", decodedText);
           }
       } catch (error) {
           if (error instanceof TypeError && error.Display.style.display = 'none'; sessionNameInput.style.display = '-kalkulator/'
          };
          await navigator.share(shareData);
          console.log('Link uspješno podijeljenmessage.includes("URLSearchParams")) {
               console.warn("Skenblock'; sessionNameInput.value = currentSessionName || ''; sessionNameInput!');
        } catch (err) {
          console.error('Greška pri dijelirani tekst nije validan URL ili query string:", decodedText);
           }.focus(); sessionNameInput.select(); }
    function saveName()jenju:', err);
          if (err.name !== 'AbortError') {
 else {
               console.error("Neočekivana greška pri ob { if (!sessionNameInput || !addNameBtn || !sessionNameDisplay            console.warn('Dijeljenje nije uspjelo ili je otkazano.');radi QR koda:", error, decodedText);
           }
           loaded || !sessionNameText) return; const newName = sessionNameInput.
          } else {
            console.log('Korisnik odustao od dijeljenja.');
          }
        }
      });
    Msg.style.display = 'none';
           duplicateWarning.style.display = 'none';
           deleteWarningDiv.style.display = 'none'; // Sakrij i ovo u slučaju greške
       }
    value.trim(); currentSessionName = newName || null; sessionNameInput.style} else {
      console.warn('Web Share API nije podržan na ovom pregledniku.');
    }
    // --- Kraj dodatka ---

}

    // Inicijalizacija skenera - OSTAJE.display = 'none'; updateNameDisplay(); checkRemoveButtonVisibility(); }
    function updateNameDisplay() { if (!addNameBtn || !session  </script>

  <!-- Tvoj originalni Statcounter kod -->
  < KAKO JE BILA U TVOM KODU
    const html5QrCode = new Html5Qrcode("reader");
    const qrConfig = {NameDisplay || !sessionNameText) return; if (currentSessionName) { sessionNameText.textContent = currentSessionName; sessionNameDisplay.style.display = 'flex'; addNameBtn.style.display = 'none';script type="text/javascript">
  var sc_project=12702047;
  var sc_invisible=1; fps: 5, qrbox: { width: 250, height: 250 } };

    Html5Qrcode.getCameras().then(devices => {
      if (devices && devices.length) {
        html5QrCode.start(
          { facingMode } else { sessionNameDisplay.style.display = 'none'; addNameBtn.style.display = 'block'; } }

    // *** FUN
  var sc_security="e75d2592";
  var scJsHost = "https://";
  document.write("<sc"+"ript type='text/javascript' src='" + scJsHost: "environment" },
          qrConfig,
          handleScan,
          (errorMessage) => { /* Ignoriraj greške detekcije */KCIJE ZA UPRAVLJANJE TRENUTNOM SESIJOM SKENIRANJA ***
    // startRemoveFromList OSTAJE KAO U TVOM KODU
    function startRemoveFromList() { if (!removeButton || !document.body.classList.contains('scanner-view')) return; +
  "statcounter.com/counter/counter.js'></"+"script>");
  </script>
  <noscript><div class="stat }
        ).then(() => {
            console.log("QR skener pokrenut.");
            updateDisplay(); // Inicijalni prikaz if (removeNameConfirm) { playSound('remove-sound'); currentSessionName = null; resetRemoveMode(); updateNameDisplay(); return; } ifcounter"><a title="Web Analytics"
  href="https://statcounter.com/" target="_blank"><img
  class="statcounter"

        }).catch(err => {
            console.error("Greška kod startanja QR skenera:", err);
            const readerDiv = document.getElementById('reader');
            readerDiv.innerHTML = `<div style="padding: 20px; text-align: center; color: (removeConfirm) { if (povijest.length > 0) { const removed = povijest.pop(); ukupno -= removed.amount; playSound('remove-sound'); if (povijest.length === 0 && currentSessionName) { removeButton.innerHTML = 'Obriši<br  src="https://c.statcounter.com/12702047/0/e75d2592/ red; font-weight: bold;">Greška pri pokretanju kamere. Provjerite dozvole i osvježite stranicu.</div>`;
            instructionDiv>Naziv?'; removeButton.classList.remove('red-btn'); removeButton.classList.add('yellow-btn'); removeConfirm = false;1/"
  alt="Web Analytics"
  referrerPolicy="no-referrer-when-downgrade"></a></div></noscript>
  <!-- End of Statcounter Code -->

</body>
</html>
